<!doctype html>
<html lang="en" article>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>è‡ªå·±æ„å»ºä¸€ä¸ªåšå®¢ç³»ç»Ÿï½œé¡¹ç›®å¤ç›˜ - Hoarfroster</title>
    <link rel="stylesheet" href="/assets/styles/post.css">
</head>
<body>
<div class="container post markdown-body"><blockquote>
<ul>
<li>æ ‡ç­¾ï¼šKotlinã€JavaScriptã€å‰ç«¯</li>
</ul>
</blockquote>
<h1>è‡ªå·±æ„å»ºä¸€ä¸ªåšå®¢ç³»ç»Ÿï½œé¡¹ç›®å¤ç›˜</h1>
<h2>ä¸ºç¥é©¬è¦æè¿™ä¸ª</h2>
<p>æœ€è¿‘å‚ä¸äº†æ˜é‡‘çš„ç¿»è¯‘è®¡åˆ’ï¼Œäº§å‡ºäº†å¤§é‡çš„ Markdown æ–‡ç« ï¼Œå¸Œæœ›æ­å»ºä¸€ä¸ªä¸ªäººç«™ï¼Œå­˜æ”¾è‡ªå·±çš„ä¸€äº›æ–‡ç« ï½</p>
<p>çœ‹äº†ä¸€äº›ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œæ„Ÿè§‰å±€é™æ€§å¤ªå¤šï¼Œä¸åˆ©äºåæœŸè‡ªå®šä¹‰ï¼Œå†åŠ ä¸Šæˆ‘è¿™ä¸ªè¶…çº§å–œæ¬¢é€ è½®å­çš„æ€§æ ¼ï¼Œäºæ˜¯ä¹ ğŸ‘€</p>
<p><img src="../images/blog-review.md-c7798e9279b942c4a4e9e38a7b461250~tplv-k3u1fbpfcp-watermark.image" alt=""></p>
<h3>æˆ‘å°±æ­å»ºäº†ä¸€ä¸ªè‡ªå·±çš„å¤„ç†ç³»ç»Ÿ</h3>
<p>åˆ«é—®æˆ‘ä¸ºå•¥è¿™æ ·åšï¼Œæˆ‘è§‰å¾—å¥½ç©ï¼ˆï¼Œè€Œä¸”è‡ªå®šä¹‰èƒ½åŠ›è¶…å¼ºï¼Œå¯ä»¥éšæ„åŠ æ§ä»¶ï¼ï¼ï¼</p>
<p><a href="https://github.com/PassionPenguin/passionpenguin.github.io/"><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/67c7b9be335b41a4818643ac7a33f588~tplv-k3u1fbpfcp-watermark.image" width="360px" /></a></p>
<h2>éœ€æ±‚åŠŸèƒ½</h2>
<ul>
<li>æ¸²æŸ“ Markdown æ ‡è®°</li>
<li>è‡ªå®šä¹‰é¡µé¢</li>
<li>åæœŸå¯ä»¥ç®€å•çš„å¯¹æ‰€æœ‰æ–‡ç« é¡µé¢ä½œæ›´æ–°</li>
<li>ä¾¿äºç§»æ¤</li>
</ul>
<h3>æœ¬æ¬¡ä½¿ç”¨çš„å·¥å…·æœ‰ï¼š</h3>
<h4>å‰ç«¯éƒ¨åˆ†</h4>
<p>åŸºç¡€çš„å‰ç«¯é¡µé¢æ„é€ ä½¿ç”¨äº†åŸç”Ÿ Vanilla JavaScript + CSS + HTMLï¼Œæ„é€ ä¸€ä¸ªé™æ€çš„æ–‡ç« å±•ç¤ºç³»ç»Ÿã€‚</p>
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/752532eed7324e869f9be889bda9cfa8~tplv-k3u1fbpfcp-watermark.image" alt="HTML CSS JS" width="640px" />
<p>åœ¨æ ·å¼æ–¹é¢ä½¿ç”¨äº† SCSS è¯­è¨€ï¼Œå¹¶ä¸”é¡ºå¸¦ä½¿ç”¨äº† GitHub çš„ä¸»é¢˜ <code>@primer</code> åº“ï¼Œå¹¶é¡ºå¸¦é­”æ”¹äº†ä¸€ç•ªï½</p>
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0f40b5ac72840338aaf4d7bdcee2b77~tplv-k3u1fbpfcp-watermark.image" alt="SCSS" width="240px" />
<h4>åç«¯éƒ¨åˆ†</h4>
<p>åœ¨æ–‡ç« å¤„ç†ï¼ˆæ ‡ç­¾è·å–ã€å›¾ç‰‡çˆ¬å–ï¼‰ä¸Šä½¿ç”¨äº† Java + Kotlin çš„ç»„åˆï¼Œä¸»è¦æ˜¯æˆ‘å¯¹ Kotlin æŒºç†Ÿçš„ï¼Œæ¯•ç«Ÿåšäº†ä¸€å¹´ Kotlin é¡¹ç›®äº† = =ã€‚</p>
<p><img src="../images/blog-review.md-887cbf9766fa44ffa1bbe9e0c9de9eb5~tplv-k3u1fbpfcp-watermark.image" alt=""></p>
<p><img src="../images/blog-review.md-3d4156bd11d9450b936181d989fe3453~tplv-k3u1fbpfcp-watermark.image" alt=""></p>
<h2>æ„å»ºæ€è·¯</h2>
<h3>åç«¯å¤„ç†</h3>
<h4>å…ƒæ•°æ®å¤„ç†</h4>
<p>Java ä¸»è¦å¤„ç†å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æ–‡ç« çš„æ ‡ç­¾ï¼ˆåˆ†ç±»ï¼‰çš„è¯»å–ï¼Œæ–‡ç« å›¾ç‰‡çš„è§£æçˆ¬å–ï¼Œä»¥åŠæ–‡ç« æ ‡é¢˜ç®€ä»‹ç­‰ä¿¡æ¯çš„è¯»å–ï¼Œå…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p>
<pre class="hljs"><code>sequenceDiagram
    participant z as Markdown æ–‡ä»¶
    participant l as JSON æ–‡ä»¶
    loop å¤„ç†æ•°æ®
        z-&gt;&gt;l: æ˜¯å¦å­˜åœ¨ è¿œç¨‹ å›¾ç‰‡
        activate z
        alt æœ‰
            l-&gt;&gt;z: ä¸‹è½½
        else æ²¡æœ‰
            l-&gt;&gt;z: è·³è¿‡
        end
        z-&gt;&gt;l: æ˜¯å¦å·²ç»æœ‰æ ‡ç­¾æ•°æ®
        activate z
        alt æœ‰
            l-&gt;&gt;z: è·³è¿‡
        else æ²¡æœ‰
            l-&gt;&gt;z: åŠ è½½æ•°æ®ï¼ˆGitHub / æœ¬åœ°ï¼‰
        end
    end
</code></pre>
<p>å…ˆçœ‹ä¸€ä¸‹æ¨¡ç‰ˆå†…å®¹ï¼Œé»˜è®¤æ¨¡ç‰ˆï¼š</p>
<pre class="hljs"><code><span class="hljs-quote">&gt; <span class="hljs-emphasis">* æ ‡ç­¾ï¼šæ ‡ç­¾ Aã€æ ‡ç­¾ B

# æ ‡é¢˜
</span></span></code></pre>
<p>ç¿»è¯‘æ¨¡ç‰ˆï¼š</p>
<pre class="hljs"><code><span class="hljs-quote">&gt; <span class="hljs-emphasis">* åŸæ–‡åœ°å€ï¼š[]()
&gt; *</span> åŸæ–‡ä½œè€…ï¼š[]()</span>
<span class="hljs-quote">&gt; <span class="hljs-emphasis">* è¯‘æ–‡å‡ºè‡ªï¼š[<span class="hljs-string">æ˜é‡‘ç¿»è¯‘è®¡åˆ’</span>](<span class="hljs-link">https://github.com/xitu/gold-miner</span>)
&gt; *</span> æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[<span class="hljs-string">https://github.com/xitu/gold-miner/blob/master/article/2021/.md</span>](<span class="hljs-link">https://github.com/xitu/gold-miner/blob/master/article/2021/.md</span>)</span>
<span class="hljs-quote">&gt; <span class="hljs-emphasis">* è¯‘è€…ï¼š
&gt; *</span> æ ¡å¯¹è€…ï¼š</span>

<span class="hljs-section"># æ ‡é¢˜</span>
</code></pre>
<hr>
<p>è¿™é‡Œçš„æ‰€æœ‰çš„ä»£ç éƒ½ä¿å­˜åœ¨äº†è¿™é‡Œï¼š<a href="https://github.com/PassionPenguin/PageGenerator/tree/master/src/main/kotlin/io/hoarfroster">PassionPenguin:PageGenerator/io.hoarfroster</a>ï¼Œé¦–å…ˆæ˜¯å®ç°è·å–æ‰€æœ‰æ–‡ä»¶ï¼š</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> {
    <span class="hljs-keyword">var</span> downloadImage = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">var</span> inputDir: String? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> args) {
        <span class="hljs-keyword">if</span> (name.contains(Regex(<span class="hljs-string">&quot;--input=(.+?)&quot;</span>)))
            inputDir = name.substring(<span class="hljs-number">8</span>)
    }
    <span class="hljs-keyword">if</span> (inputDir == <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">val</span> dir = File(<span class="hljs-string">&quot;<span class="hljs-subst">${inputDir}</span>/documents/&quot;</span>)
    <span class="hljs-keyword">val</span> files = dir.listFiles { _, name -&gt; name.endsWith(<span class="hljs-string">&quot;.md&quot;</span>) }
}
</code></pre>
<p>ç„¶åä½¿ç”¨ <code>mapIndexed</code> éå†æ‰€æœ‰ Markdown æ–‡ä»¶ï¼Œè¯»å–æ–‡ä»¶ï¼š</p>
<pre class="hljs"><code>files?.mapIndexed { index, it -&gt; 
    <span class="hljs-keyword">var</span> sourceMarkdown = it.readText()
    <span class="hljs-keyword">val</span> document = Jsoup.parse(HtmlRenderer.builder().build().render(Parser.builder().build().parse(sourceMarkdown)))
}
</code></pre>
<p>è¿™é‡Œä½¿ç”¨äº† <code>commonmark</code> å’Œ <code>Jsoup</code> è§£æäº† Markdown æ–‡ä»¶ä¸º HTML æ–‡ä»¶ï¼ˆå…¶å®ä¹Ÿå¯ä»¥ä¸ç”¨ï¼Œå…¨æ–‡æ­£åˆ™åŒ¹é…ï¼Œä½†æ„Ÿè§‰è¿˜æ˜¯æœ‰äº›éº»çƒ¦ï¼‰ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯æœ‰ï¼š</p>
<ul>
<li>æ ‡é¢˜</li>
<li>æ ‡ç­¾</li>
<li>ç®€ä»‹</li>
<li>æ–‡ä»¶å</li>
<li>æœ€åä¿®æ”¹æ—¶é—´</li>
<li>ï¼ˆè¿œç¨‹é“¾æ¥ï¼‰</li>
<li>ï¼ˆè¯‘è€…ï¼‰</li>
</ul>
<h5>æ ‡é¢˜</h5>
<pre class="hljs"><code>document.selectFirst(<span class="hljs-string">&quot;h1&quot;</span>).text()
</code></pre>
<h5>æ ‡ç­¾</h5>
<ol>
<li>GitHub æ ‡ç­¾</li>
</ol>
<p>æ€è·¯å¾ˆç®€å•ï¼Œç›´æ¥ç”¨ URLConnection è¯»å–æ•°æ®å¹¶è§£æå°±å¥½äº†ï¼š</p>
<pre class="hljs"><code><span class="hljs-keyword">package</span> io.hoarfroster

<span class="hljs-keyword">import</span> org.jsoup.Jsoup
<span class="hljs-keyword">import</span> java.net.URL
<span class="hljs-keyword">import</span> javax.net.ssl.HttpsURLConnection

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RetrieveResult</span></span>(<span class="hljs-keyword">val</span> tags: MutableList&lt;Tag&gt;)

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">retrieveResult</span><span class="hljs-params">(repoUrl: <span class="hljs-type">String</span>)</span></span>: RetrieveResult {
    println(<span class="hljs-string">&quot; - Processing tags data&quot;</span>)
    <span class="hljs-keyword">val</span> tags: MutableList&lt;Tag&gt; = mutableListOf()
    <span class="hljs-keyword">val</span> connection = URL(repoUrl.replace(<span class="hljs-string">&quot;blob&quot;</span>, <span class="hljs-string">&quot;commits&quot;</span>).replace(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;%20&quot;</span>)).openConnection() <span class="hljs-keyword">as</span> HttpsURLConnection
    <span class="hljs-keyword">val</span> document = Jsoup.parse(connection.inputStream.bufferedReader().readText())
    document.select(<span class="hljs-string">&quot;[data-hovercard-type=\&quot;pull_request\&quot;][data-url].issue-link.js-issue-link&quot;</span>)
        .filter { e -&gt;
            Regex(<span class="hljs-string">&quot;#([0-9]+?)$&quot;</span>).matches(e.html())
        }.map { e -&gt;
            Regex(<span class="hljs-string">&quot;#([0-9]+?)$&quot;</span>).find(e.html())?.groupValues?.<span class="hljs-keyword">get</span>(<span class="hljs-number">1</span>)
        }.forEach { it -&gt;
            Thread.sleep(<span class="hljs-number">1000</span>)
            <span class="hljs-keyword">val</span> conn = URL(<span class="hljs-string">&quot;https://github.com/xitu/gold-miner/pull/<span class="hljs-variable">$it</span>&quot;</span>).openConnection() <span class="hljs-keyword">as</span> HttpsURLConnection
            <span class="hljs-keyword">val</span> doc = Jsoup.parse(conn.inputStream.bufferedReader().readText())
            <span class="hljs-keyword">if</span> (doc.select(<span class="hljs-string">&quot;.js-issue-labels &gt; *&quot;</span>).size &gt; <span class="hljs-number">0</span>
                &amp;&amp; doc.selectFirst(<span class="hljs-string">&quot;.js-issue-labels&quot;</span>).text().contains(<span class="hljs-string">&quot;ç¿»è¯‘å®Œæˆ&quot;</span>)
            ) {
                doc.select(<span class="hljs-string">&quot;.js-issue-labels &gt; *&quot;</span>).forEach {
                    <span class="hljs-keyword">if</span>(!it.text().contains(<span class="hljs-string">&quot;ç¿»è¯‘å®Œæˆ&quot;</span>))
                        tags.add(Tag(it.text()))
                }
            }
        }
    <span class="hljs-keyword">return</span> RetrieveResult(tags = tags)
}
</code></pre>
<ol start="2">
<li>æ–‡å†…æ ‡ç­¾</li>
</ol>
<p>æ›´ç®€å•äº†ï¼Œç›´æ¥ RegExï¼š</p>
<pre class="hljs"><code><span class="hljs-keyword">val</span> tags = mutableListOf&lt;Tag&gt;()
Regex(<span class="hljs-string">&quot;æ ‡ç­¾ï¼š(.+?)\n&quot;</span>).find(sourceMarkdown)?.groupValues?.<span class="hljs-keyword">get</span>(<span class="hljs-number">1</span>)?.split(<span class="hljs-string">&quot;ã€&quot;</span>)?.forEach {
    tags.add(Tag(it))
}
</code></pre>
<h5>ç®€ä»‹</h5>
<p>ç›´æ¥è¯»å–ç¬¬ä¸€æ®µæ–‡å­—å†…å®¹ï¼Œå½“ä½œç®€ä»‹å†…å®¹ï¼š</p>
<pre class="hljs"><code><span class="hljs-keyword">var</span> description = <span class="hljs-string">&quot;&quot;</span>
<span class="hljs-keyword">for</span> (e <span class="hljs-keyword">in</span> document.select(<span class="hljs-string">&quot;p&quot;</span>)) {
    <span class="hljs-keyword">if</span> (e.text().isNotBlank()) {
        description = e.text()
        <span class="hljs-keyword">break</span>
    }
}
</code></pre>
<h5>æ–‡ä»¶å</h5>
<pre class="hljs"><code>it.path.replace(<span class="hljs-string">&quot;<span class="hljs-subst">${inputDir}</span>/documents/&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)
</code></pre>
<h5>æœ€åä¿®æ”¹æ—¶é—´</h5>
<pre class="hljs"><code>Date(it.lastModified()).toString()
</code></pre>
<h5>ï¼ˆè¿œç¨‹é“¾æ¥ï¼‰</h5>
<pre class="hljs"><code>Regex(<span class="hljs-string">&quot;æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š\\[.+?]\\((.+?)\\)&quot;</span>).find(sourceMarkdown)?.groupValues?.<span class="hljs-keyword">get</span>(<span class="hljs-number">1</span>) ?: <span class="hljs-string">&quot;&quot;</span>
</code></pre>
<h5>ï¼ˆè¯‘è€…ï¼‰</h5>
<pre class="hljs"><code>Regex(&quot;è¯‘è€…ï¼š\\[(.+?)]&quot;).find(sourceMarkdown)?.groupValues?.get(1) ?: &quot;&quot;
</code></pre>
<h4>å›¾ç‰‡ä¸‹è½½</h4>
<p>æŒºç®€å•çš„ = =ï¼š</p>
<pre class="hljs"><code>println(<span class="hljs-string">&quot; - Processing image&quot;</span>)
document.select(<span class="hljs-string">&quot;img&quot;</span>).forEach { img -&gt;
    <span class="hljs-comment">/* Download external resources */</span>
    <span class="hljs-keyword">val</span> alt = img.attr(<span class="hljs-string">&quot;alt&quot;</span>)
    <span class="hljs-keyword">val</span> urlString = img.attr(<span class="hljs-string">&quot;src&quot;</span>)

    with(
        File(
        <span class="hljs-string">&quot;<span class="hljs-subst">${inputDir}</span>/images/<span class="hljs-subst">${it.path.replace(<span class="hljs-string">&quot;<span class="hljs-subst">${inputDir}</span>/documents/&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)
            }</span>-<span class="hljs-subst">${urlString.getLastSegment()}</span>&quot;</span>
        )
    ) {
        <span class="hljs-comment">/* Only download the image if the file is not existed */</span>
        <span class="hljs-keyword">if</span> ((!<span class="hljs-keyword">this</span>.isFile || !<span class="hljs-keyword">this</span>.exists()) &amp;&amp; !urlString.startsWith(<span class="hljs-string">&quot;../images/&quot;</span>)) {
            Thread.sleep(<span class="hljs-number">1000</span>)
            println(<span class="hljs-string">&quot;   - Processing image <span class="hljs-variable">$urlString</span>&quot;</span>)
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.parentFile.isDirectory || <span class="hljs-keyword">this</span>.parentFile.exists())
                <span class="hljs-keyword">this</span>.parentFile.mkdirs()
            <span class="hljs-keyword">this</span>.createNewFile()
            <span class="hljs-keyword">val</span> imageUrlConn = URL(urlString).openConnection()
            imageUrlConn.setRequestProperty(<span class="hljs-string">&quot;referer&quot;</span>, URL(urlString).host)
            imageUrlConn.setRequestProperty(
                <span class="hljs-string">&quot;user-agent&quot;</span>,
                <span class="hljs-string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Safari/537.36&quot;</span>
            )
            imageUrlConn.setRequestProperty(<span class="hljs-string">&quot;origin&quot;</span>, <span class="hljs-string">&quot;https://www.medium.com/&quot;</span>)

            <span class="hljs-keyword">val</span> `<span class="hljs-keyword">in</span>`: InputStream = BufferedInputStream(imageUrlConn.getInputStream())

            <span class="hljs-keyword">val</span> <span class="hljs-keyword">out</span> = ByteArrayOutputStream()
            <span class="hljs-keyword">val</span> buf = ByteArray(<span class="hljs-number">1024</span>)
            <span class="hljs-keyword">var</span> n: <span class="hljs-built_in">Int</span>
            <span class="hljs-keyword">while</span> (-<span class="hljs-number">1</span> != `<span class="hljs-keyword">in</span>`.read(buf).also { n = it }) {
                <span class="hljs-keyword">out</span>.write(buf, <span class="hljs-number">0</span>, n)
            }
            <span class="hljs-keyword">out</span>.close()
            `<span class="hljs-keyword">in</span>`.close()
            <span class="hljs-keyword">val</span> response = <span class="hljs-keyword">out</span>.toByteArray()
            <span class="hljs-keyword">this</span>.outputStream().write(response)
            sourceMarkdown = sourceMarkdown.replace(
                <span class="hljs-string">&quot;&quot;&quot;![<span class="hljs-variable">$alt</span>](<span class="hljs-variable">$urlString</span>)&quot;&quot;&quot;</span>,
                <span class="hljs-string">&quot;&quot;&quot;![<span class="hljs-variable">$alt</span>](../images/<span class="hljs-subst">${
                    it.path.replace(
            <span class="hljs-string">&quot;<span class="hljs-subst">${inputDir}</span>/documents/&quot;</span>,
            <span class="hljs-string">&quot;&quot;</span>
                    )
                }</span>-<span class="hljs-subst">${urlString.getLastSegment()}</span>)&quot;&quot;&quot;</span>
            )
            it.writeText(sourceMarkdown)
        }
    }
}
</code></pre>
<p>ç„¶åæ¯æ¬¡è¿è¡Œçš„æ—¶å€™ï¼Œç›´æ¥æ‰§è¡Œï¼š</p>
<ul>
<li>/Users/penguin/Desktop/PageGenerator/build/libs/PageGenerator.jarï¼šGradle ç”Ÿæˆçš„ JAR æ–‡ä»¶</li>
<li>/Library/WebServer/Documentsï¼šæ–‡ä»¶ä»“åº“</li>
</ul>
<pre class="hljs"><code>java -jar /Users/penguin/Desktop/PageGenerator/build/libs/PageGenerator.jar --input=/Library/WebServer/Documents/ --downloadImage
</code></pre>
<h4>ç”Ÿæˆ HTML æ–‡ä»¶ï¼š</h4>
<p>ç»§ç»­é­”æ”¹äº† <code>markdown-it</code> åº“ï¼Œå…³é”®ä»£ç æŒºç®€å•çš„ï¼š</p>
<pre class="hljs"><code><span class="hljs-built_in">exports</span>.render = <span class="hljs-keyword">async</span> (config) =&gt; {
  <span class="hljs-keyword">const</span> mdFilePath = path.resolve(config.cwd, config[<span class="hljs-string">&#x27;mdFile&#x27;</span>])
  <span class="hljs-keyword">let</span> renderContent = md.render(fse.readFileSync(mdFilePath, <span class="hljs-string">&#x27;utf-8&#x27;</span>))
  <span class="hljs-keyword">let</span> parser = <span class="hljs-keyword">new</span> DOMParser()
  <span class="hljs-keyword">let</span> <span class="hljs-built_in">document</span> = parser.parseFromString(renderContent, <span class="hljs-string">&#x27;text/html&#x27;</span>)
  <span class="hljs-keyword">let</span> title = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">&#x27;h1&#x27;</span>)[<span class="hljs-number">0</span>].textContent
  <span class="hljs-keyword">let</span> html = <span class="hljs-string">`&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;
    &lt;title&gt;<span class="hljs-subst">${title}</span> - Hoarfroster&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/assets/styles/post.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot;
      href=&quot;//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.5.0/build/styles/atom-one-light.min.css&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;container post markdown-body&quot;&gt;<span class="hljs-subst">${renderContent}</span>&lt;/div&gt;
&lt;div class=&quot;footer&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;script src=&quot;/assets/scripts/index.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;init()&lt;/script&gt;
&lt;/html&gt;
`</span>
  config.out = path.resolve(config.cwd, config.out)
  <span class="hljs-keyword">const</span> fileReg = <span class="hljs-regexp">/([^/\\]*)\.[^/\\]+$/</span>
  <span class="hljs-keyword">if</span> (!config.out.match(fileReg)) {
    <span class="hljs-comment">// if no file suffix, use the same as markdown file</span>
    config.out = path.resolve(
      config.out,
      mdFilePath.match(fileReg)[<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;.html&#x27;</span>
    )
  }
  fse.writeFileSync(config.out, html)
}
</code></pre>
<h3>å‰ç«¯éƒ¨åˆ†</h3>
<p>è¿™é‡Œé‡åˆ°äº†ä¸€ä¸ªè¶…çº§å¤§çš„å‘ï¼Œå³ GitHub çš„æ ·å¼å’Œ <code>@primer</code> åº“çš„å†…å®¹å®Œå…¨ä¸ä¸€æ ·ï¼äºæ˜¯ä¹æˆ‘è¢«è¿«æ§åˆ¶å°æŠ„äº†å‡ åƒè¡Œçš„ CSS é¢œè‰²å˜é‡ï¼š</p>
<p><img src="../images/blog-review.md-9ee3d640ea4c4069b86855811642e0bb~tplv-k3u1fbpfcp-watermark.image" alt=" .png"></p>
<p>ç»“æœ GitHub æœ€è¿‘åˆæ¨äº†æ–°çš„ä¸»é¢˜ï¼Œè¿™æ˜¯è¦æ¦¨å¹²ä¼é¹…å˜› = =ã€‚</p>
<p>æœ€åä½¿ç”¨äº† JavaScript ä¸ºæ¯ä¸€ç¯‡æ–‡ç« åŠ ä¸Š Header ä»¥åŠ Footerï¼š</p>
<p><img src="../images/blog-review.md-c3994e529946467c9b68232ae11bdc17~tplv-k3u1fbpfcp-watermark.image" alt="Screen Shot 2021-03-18 at 10.31.33 PM.png"></p>
<h2>å½“å‰æ•ˆæœ</h2>
<h3>ä¸»é¡µ</h3>
<p><img src="../images/blog-review.md-1736ba3f839441a19bb0874a7adefc11~tplv-k3u1fbpfcp-watermark.image" alt="gh.hoarfroster.space_.png"></p>
<h3>404 Not Found</h3>
<p><img src="../images/blog-review.md-b212c1f946424abe9d231f025cf6e3ff~tplv-k3u1fbpfcp-watermark.image" alt="gh.hoarfroster.space_404.png"></p>
<h3>About</h3>
<p><img src="../images/blog-review.md-996cc67b25af46df98a092b369a04643~tplv-k3u1fbpfcp-watermark.image" alt="gh.hoarfroster.space_about.html.png"></p>
<h3>æ­£æ–‡å†…å®¹</h3>
<p><img src="../images/blog-review.md-2e694e71557b4018957ff4ffc9b58e3b~tplv-k3u1fbpfcp-watermark.image" alt="gh.hoarfroster.space_archive_messengers-like-imageview.html.png"></p>
<h2>GitHub CI</h2>
<pre class="hljs"><code><span class="hljs-attr">name:</span> <span class="hljs-string">Page</span> <span class="hljs-string">Automator</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">master</span> ]
  <span class="hljs-attr">pull_request:</span>
    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">master</span> ]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">build:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Set</span> <span class="hljs-string">up</span> <span class="hljs-string">JDK</span> <span class="hljs-number">1.8</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-java@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">java-version:</span> <span class="hljs-number">1.8</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Use</span> <span class="hljs-string">Node.js</span> <span class="hljs-number">15.</span><span class="hljs-string">x</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v1</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-number">15.</span><span class="hljs-string">x</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">setup</span> <span class="hljs-string">git</span> <span class="hljs-string">config</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          git config --global user.name &quot;Hoarfroster Bot&quot;
          git config --global user.email &quot;&lt;penguin.zhang@qq.com&gt;&quot;
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@master</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">repository:</span> <span class="hljs-string">PassionPenguin/PageGenerator</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">./page-generator</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@master</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">./documents</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">with</span> <span class="hljs-string">Gradle</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          cd ./page-generator
          ./gradlew build
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">Structure</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          echo &quot;Processing Markdown Files&quot;
          java -jar page-generator/build/libs/PageGenerator.jar --input=./documents
          cd ./documents
</span>
          <span class="hljs-string">git</span> <span class="hljs-string">add</span> <span class="hljs-string">*</span>
          <span class="hljs-string">if</span> [[ <span class="hljs-string">-n</span> <span class="hljs-string">$(git</span> <span class="hljs-string">status</span> <span class="hljs-string">-uno</span> <span class="hljs-string">--porcelain)</span> ]]
          <span class="hljs-string">then</span>
            <span class="hljs-string">git</span> <span class="hljs-string">commit</span> <span class="hljs-string">-m</span> <span class="hljs-string">&quot;Generate Structure&quot;</span>
            <span class="hljs-string">git</span> <span class="hljs-string">push</span> <span class="hljs-string">origin</span> <span class="hljs-string">master</span>
          <span class="hljs-string">fi</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">NPM</span> <span class="hljs-string">Install</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          npm i -g markdown-html-gen
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">HTML</span> <span class="hljs-string">Pages</span> <span class="hljs-string">with</span> <span class="hljs-string">Markdown</span> <span class="hljs-string">Files</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          echo &quot;Generating HTML Files&quot;
          cd ./documents
          for f in documents/*.md
            do
              htmlpath=${f/documents/archive}
              htmlpath=${htmlpath/md/html}
              md2html &quot;$f&quot; -o ./archive
              echo &quot; - Generated $htmlpath&quot;
            done
</span>
          <span class="hljs-string">git</span> <span class="hljs-string">add</span> <span class="hljs-string">*</span>
          <span class="hljs-string">if</span> [[ <span class="hljs-string">-n</span> <span class="hljs-string">$(git</span> <span class="hljs-string">status</span> <span class="hljs-string">-uno</span> <span class="hljs-string">--porcelain)</span> ]]
          <span class="hljs-string">then</span>
            <span class="hljs-string">git</span> <span class="hljs-string">commit</span> <span class="hljs-string">-m</span> <span class="hljs-string">&quot;Build Pages&quot;</span>
            <span class="hljs-string">git</span> <span class="hljs-string">push</span> <span class="hljs-string">origin</span> <span class="hljs-string">master</span>
          <span class="hljs-string">fi</span>
</code></pre>
<h2>åæ€ä¸æ€»ç»“</h2>
<p>å°è¯•å€’æ˜¯ä¸é”™ï¼Œä¸è¿‡è¿˜æœ‰å¾…ç»§ç»­æ”¹å–„ï¼š</p>
<ul>
<li>æŒ‰ç…§ Tag æŸ¥çœ‹ï¼ˆé›å½¢å€’æ˜¯æ­å»ºå¥½äº†ï¼‰</li>
<li>æœç´¢</li>
<li>ä¼˜åŒ– CI/CDï¼ˆç°åœ¨è¿˜æ˜¯æ‰‹å·¥æœ¬åœ°è·‘ï¼Œå‡†å¤‡ç”¨ WebHookï¼Œè®©æœåŠ¡å™¨æ¥ GitHub çš„ WebHookï¼Œçˆ¬å–ï¼Œç„¶å Push å› GitHub ä¸Šé¢ï¼‰</li>
</ul>
<p>æœ‰ä¸ªé—®é¢˜åº”è¯¥ä¼˜åŒ–ï¼š</p>
<ul>
<li>Kotlin çš„ PageGenerator ä»£ç æ··ä¹±</li>
</ul>
<p>è¯è¯´ï¼Œåœ¨è¿™ä¸‰ä¸ªæœˆå†…ï¼Œç¿»è¯‘+æ ¡å¯¹+åŸåˆ›æ–‡åˆ°äº† 100 ç¯‡å’¯ï¼Œæ’’èŠ±æ’’èŠ±ï¼ŒèŠœæ¹–æ¹–ï½ ğŸ‰ğŸ‰</p>
<blockquote>
<p>æœ€åçš„æœ€åï¼Œç»§ç»­æ¨å¹¿ä¸€ä¸‹ <a href="https://github.com/xitu/gold-miner">æ˜é‡‘ç¿»è¯‘è®¡åˆ’</a>ï¼Œè¿™æ˜¯ä¸€ä¸ªç¿»è¯‘ä¼˜è´¨äº’è”ç½‘æŠ€æœ¯æ–‡ç« çš„ç¤¾åŒºï¼Œæ–‡ç« æ¥æºä¸º æ˜é‡‘ ä¸Šçš„è‹±æ–‡åˆ†äº«æ–‡ç« ã€‚å†…å®¹è¦†ç›–åŒºå—é“¾ã€äººå·¥æ™ºèƒ½ã€Androidã€iOSã€å‰ç«¯ã€åç«¯ã€è®¾è®¡ã€äº§å“ã€ç®—æ³•å’Œå…¶ä»–ç­‰é¢†åŸŸï¼Œä»¥åŠå„å¤§å‹ä¼˜è´¨ å®˜æ–¹æ–‡æ¡£åŠæ‰‹å†Œï¼Œè¯»è€…ä¸ºçƒ­çˆ±æ–°æŠ€æœ¯çš„æ–°é”å¼€å‘è€…ã€‚</p>
<p>æ˜é‡‘ç¿»è¯‘è®¡åˆ’ç›®å‰ç¿»è¯‘å®Œæˆ 2345 ä½™ç¯‡æ–‡ç« ï¼Œå®˜æ–¹æ–‡æ¡£åŠæ‰‹å†Œ 13 ä¸ªï¼Œå…±æœ‰ 1000 ä½™åè¯‘è€…è´¡çŒ®ç¿»è¯‘å’Œæ ¡å¯¹ã€‚</p>
<p>æ¬¢è¿å„ä½åŠ å…¥æˆ‘ä»¬å—·ï¼</p>
</blockquote>
<ul>
<li>æœ¬æ–‡æ­£åœ¨å‚ä¸ã€Œæ˜é‡‘ 2021 æ˜¥æ‹›é—¯å…³æ´»åŠ¨ã€, ç‚¹å‡»æŸ¥çœ‹ <a href="https://juejin.cn/post/6939329638506168334">æ´»åŠ¨è¯¦æƒ…</a></li>
</ul>
</div>
<div class="footer"></div>
</body>
<script src="/assets/scripts/index.min.js"></script>
<script>init()</script>
</html>
