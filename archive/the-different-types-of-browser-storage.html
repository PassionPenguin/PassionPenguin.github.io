<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>不同类型的浏览器存储 - Hoarfroster</title>
    <link rel="stylesheet" href="/assets/styles/post.css">
    <link rel="stylesheet"
            href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.5.0/build/styles/atom-one-light.min.css">
</head>
<body>
<div class="container post markdown-body">
    <blockquote>
        <ul>
            <li>原文地址：<a href="https://medium.com/better-programming/the-different-types-of-browser-storage-82b918cb3cf8">The Different Types of Browser Storage</a>
            </li>
            <li>原文作者：<a href="https://medium.com/@techforum">Albin Issac</a></li>
            <li>译文出自：<a href="https://github.com/xitu/gold-miner">掘金翻译计划</a></li>
            <li>本文永久链接：<a href="https://github.com/xitu/gold-miner/blob/master/article/2021/the-different-types-of-browser-storage.md">https://github.com/xitu/gold-miner/blob/master/article/2021/the-different-types-of-browser-storage.md</a>
            </li>
            <li>译者：<a href="https://github.com/flashhu">flashhu</a></li>
            <li>校对者：<a href="https://github.com/PassionPenguin">PassionPenguin</a>，<a href="https://github.com/k8scat">k8scat</a>
            </li>
        </ul>
    </blockquote>
    <h1>不同类型的浏览器存储</h1>
    <p><img src="https://cdn-images-1.medium.com/max/2000/0*6UmrGOz0O2pvmwHT" alt="@kundeleknabiegunie unsplash.com">
    </p>
    <p>现代浏览器为如何在用户浏览器中存储网站数据提供了多样的选择，允许按需查询这些数据。这使得网站所有者能长期保留数据，保存网页内容或文档供离线使用，存储用户偏好，应用状态等。</p>
    <p>在本教程中，我们将讨论可以在用户浏览器上存储网站数据的不同类型的浏览器存储。</p>
    <h4>浏览器存储的使用场景</h4>
    <ul>
        <li>个性化网站偏好</li>
        <li>持久化站点活动</li>
        <li>存储登录状态</li>
        <li>本地保存数据和资源以便快速下载或离线使用</li>
        <li>本地保存 Web 应用生成的文档供离线使用</li>
        <li>提升网站性能</li>
        <li>减少对后端服务器的请求</li>
    </ul>
    <h4>浏览器存储的类型</h4>
    <ul>
        <li>Cookies</li>
        <li>本地存储（localStorage）</li>
        <li>会话存储（sessionStorage）</li>
        <li>IndexedDB</li>
        <li>Web SQL</li>
        <li>缓存存储（CacheStorage）</li>
    </ul>
    <h2>Cookies</h2>
    <p>它是在客户端存储数据的传统方法，因为在 HTML5 出现前，这是浏览器存储的唯一选择。</p>
    <p>Cookie 保存客户端的数据，为网站访问者提供个性化的体验。Cookie 在服务端生成，随响应发到客户端，每次请求都会与服务器交换数据。服务器可以根据 cookie 中的数据向用户发送个性化的内容。</p>
    <p>Cookie 可以通过 JavaScript 中的
        <code>document.cookie</code> 被创建，更新或读取。<code>HTTPOnly</code> cookie 标志可在 JavaScript 中被用于限制 cookie 访问，从而减少一些安全隐患，如被跨站脚本读取（这类 cookie 仅供服务器端访问）。
    </p>
    <h4>Cookie 属性</h4>
    <pre class="hljs"><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Secure
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; HttpOnly

Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Strict
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=Lax
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; SameSite=None; Secure

// 也可以同时提供多个属性，例如：
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly
</code></pre>
    <p>Cookie 可分为两类：会话期 cookie 和持久性 cookie。</p>
    <p><strong>会话期 cookie</strong></p>
    <p>会话期 cookie 不需要指定 <code>Expires</code> 或 <code>Max-Age</code> 属性，在浏览器关闭时会被移除。</p>
    <p><strong>持久性 cookie</strong></p>
    <p>持久性 cookie 指定 <code>Expires</code> 或 <code>Max-Age</code> 属性。Cookie 不会在浏览器关闭时过期，但是会在特定的日期（<code>Expires</code>）或时间长度（<code>Max-Age</code>）过期。
    </p>
    <p>通过在 cookie 头部中设置 <code>domain</code> 选项，某个域中的 cookie 可以访问其他子域。</p>
    <pre class="hljs"><code>Set-Cookie: test=test-value; Domain=example.com - cookie 可用于 example.com 及子域
</code></pre>
    <h4>Cookie 的局限性</h4>
    <ul>
        <li>只能存储 4 KB 的数据，具体限制取决于浏览器</li>
        <li>一个域下的 cookie 数量有限制，具体取决于浏览器（如 20 个）</li>
        <li>跨域 cookie 的总数有限制，具体取决于浏览器（如 300 个）。一旦达到限制数量，为存储新的 cookie，最老的 cookie 将被移除。</li>
        <li>Cookie 数据在每次请求时都被会发到服务器。这将消耗额外的带宽并影响性能。</li>
        <li>可能被第三方读取数据（如第三方 cookie）</li>
    </ul>
    <p>Cookie 会导致多种安全问题，因此现在建议尽可能使用现代化存储 API。</p>
    <h2>Web Storage API</h2>
    <p>Web Storage API 允许 Web 应用在用户浏览器中本地存储数据。 这个 API 已作为 HTML5 标准的一部分。</p>
    <p>相比 cookie，这类存储的限制更多 —— 比如, 至少 5 MB（实际大小取决于浏览器）。这些信息只在客户端，不会和服务器共享。服务器没有任何访问权限来修改数据。</p>
    <p>数据不能在域之间共享，包括子域。每个源（协议或域的组合）都将有唯一的存储空间 —— 所有 API 操作都在源对应的存储空间中执行。</p>
    <p>为了在用户浏览器中存储数据，Web Storage API 提供了两个不同的对象：<code>sessionStorage</code> 和 <code>localStorage</code>。</p>
    <h4>localStorage</h4>
    <p><code>localStorage</code> 对象存储没有过期日期的数据。这些数据在浏览器关闭时不会被删除，而且在之后的几天、几周、几年内均可用直到被网站或用户删除。</p>
    <h4>sessionStorage</h4>
    <p><code>sessionStorage</code> 对象除只存储一个对话的数据外，与 <code>localStorage</code> 对象一致。 当用户关闭特定的浏览器标签页时，对应的数据会被删除。</p>
    <p>Web Storage API 以键/值对形式存储数据。所有数据都存储为字符串，所有被添加到存储空间中的数据会被隐式转换为字符串类型。在查询数据时，它将类型显式转换为所需类型。<code>JSON.parse()</code> 和
        <code>JSON.stringify()</code> 方法可用于序列化和反序列化对象数据。</p>
    <pre class="hljs" v-pre><code><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">"-//W3C//DTD HTML 4.01 Strict//EN"</span> <span class="hljs-meta-string">"http://www.w3.org/TR/html4/strict.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Browser Storage Demos - Web Storage API <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span> = <span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">

			<span class="hljs-comment">// 检查浏览器支持情况</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span>(Storage) !== <span class="hljs-string">"undefined"</span>) {

				 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addToStorage</span>(<span class="hljs-params"></span>)
				 </span>{
				     <span class="hljs-comment">// 通过以下任一形式将数据添加至本地存储</span>
				     localStorage.setItem(<span class="hljs-string">"testlocal"</span>, <span class="hljs-string">"test Local Data"</span>);
				     <span class="hljs-comment">//localStorage.testlocal= "test Local Data";</span>

				      <span class="hljs-comment">// 通过以下任一形式将数据添加至会话存储</span>
				      sessionStorage.setItem(<span class="hljs-string">"testsession"</span>, <span class="hljs-string">"test Session Data"</span>);
				      <span class="hljs-comment">//sessionStorage.testsession=  "test Session Data";</span>

                                      <span class="hljs-comment">// 添加 JSON 对象到存储</span>
				      <span class="hljs-keyword">var</span> testObject = { <span class="hljs-string">'test1'</span>: <span class="hljs-number">1</span>, <span class="hljs-string">'test2'</span>: <span class="hljs-number">2</span>, <span class="hljs-string">'test3'</span>: <span class="hljs-number">3</span> };
				      localStorage.setItem(<span class="hljs-string">'testObject'</span>, <span class="hljs-built_in">JSON</span>.stringify(testObject));
				 }

				 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeFromStorage</span>(<span class="hljs-params"></span>)
				 </span>{
				      <span class="hljs-comment">// 从本地存储中移除某键/值对</span>
				      localStorage.removeItem(<span class="hljs-string">"testlocal"</span>);

                                      <span class="hljs-comment">// 清空存储</span>
				      <span class="hljs-comment">//localStorage.clear();</span>

				      <span class="hljs-comment">// 从会话存储中删除某键/值对</span>
				      sessionStorage.removeItem(<span class="hljs-string">"testsession"</span>);
				      <span class="hljs-comment">//sessionStorage.clear();</span>
				 }

				 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readDataFromStrage</span>(<span class="hljs-params"></span>)
				 </span>{

				      <span class="hljs-comment">// 从本地存储中读取数据</span>
				      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML= <span class="hljs-string">"Local Storage Data.."</span>+localStorage.getItem(<span class="hljs-string">"testlocal"</span>)+<span class="hljs-string">"&lt;br /&gt;"</span>;

                                      <span class="hljs-comment">// 从会话存储中读取数据</span>
				      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML+=<span class="hljs-string">"Session Storage Data.."</span>+sessionStorage.getItem(<span class="hljs-string">"testsession"</span>)+<span class="hljs-string">"&lt;br /&gt;"</span>;

                                      <span class="hljs-comment">// 从存储中获取 JSON 数据</span>
				      <span class="hljs-keyword">var</span> retrievedObject = localStorage.getItem(<span class="hljs-string">'testObject'</span>);
				      <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML+=<span class="hljs-string">"JSON Data From Storage: "</span>+<span class="hljs-built_in">JSON</span>.stringify(retrievedObject);
				 }
			} <span class="hljs-keyword">else</span> {
			 <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No Web Storage support.."</span>);
			}
		</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
		Welcome to Browser Storage Demos - Web Storage API	<span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"readDataFromStrage()"</span>&gt;</span>Read<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"addToStorage()"</span>&gt;</span>Add data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"removeFromStorage()"</span>&gt;</span>Delete data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
    <p>Web Storage API 的调用是同步的，因此它们可能会影响 UI 渲染。也因为如此，我们仅应该使用 Web Storage API 存储和查询少量数据。在用户浏览器上使用 Web Storage API 存储及查询数据是便捷的 —— 所有现代浏览器都支持 Web Storage API。</p>
    <hr>
    <h2>IndexedDB 存储</h2>
    <p>IndexedDB 是一个基于 JavaScript 的面向对象数据库。IndexedDB 允许你存储和查询键（主键，如 SSN）索引的对象。任何结构化克隆算法支持的对象（如：视频、图片）都可以被存储。IndexedDB 的使用比 Web Storage API 复杂得多。</p>
    <p>IndexedDB 是一种在用户浏览器中持久化存储大量数据的方法。IndexedDB 允许你创建具有不用关心网络可用性这一高级功能的 Web 应用。这些应用在线、离线都可以工作。IndexedDB 对需要存储大量数据的应用及工作时不要求网络持续连通的应用而言非常有用。</p>
    <p>IndexedDB API 是异步的，不会阻塞 UI 渲染。这个 API 使用索引以支持对数据的高性能搜索。</p>
    <p>创建数据库模式及对象，打开数据库连接，然后在一系列事务中查询和更新数据。IndexedDB 允许存储大量结构化数据。具体大小取决于浏览器。</p>
    <p>数据库对源（域/协议/端口）是私有的，因此任何网站不能访问其他网站的 IndexedDB 存储。</p>
    <pre class="hljs" v-pre><code><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">"-//W3C//DTD HTML 4.01 Strict//EN"</span> <span class="hljs-meta-string">"http://www.w3.org/TR/html4/strict.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Browser Storage Demos - IndexDB API <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>


		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span> = <span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">

			<span class="hljs-comment">// 检查浏览器支持情况</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.indexedDB) {

				<span class="hljs-comment">// 示例数据</span>
				<span class="hljs-keyword">const</span> customerData = [{ <span class="hljs-attr">ssn</span>: <span class="hljs-string">"444-44-4444"</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"test1"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"test1@company.com"</span> },
									  { <span class="hljs-attr">ssn</span>: <span class="hljs-string">"555-55-5555"</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"test2"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">32</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"test2@home.org"</span> }];
				<span class="hljs-keyword">const</span> dbName = <span class="hljs-string">"testDB"</span>;
				<span class="hljs-keyword">var</span> db;
				<span class="hljs-comment">// 打开数据库，如果数据库不存在，则创建数据库</span>
				<span class="hljs-comment">// 指定数据库名称和版本，如果需要修改数据库结构，则更新版本号</span>
				<span class="hljs-keyword">var</span> request = indexedDB.open(dbName, <span class="hljs-number">2</span>);

				<span class="hljs-comment">// 错误处理程序</span>
				request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
					<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"error: "</span>);
				};

				<span class="hljs-comment">// 成功处理程序</span>
				request.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
					db = request.result;
					<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"success: "</span>+ db);
				};

				<span class="hljs-comment">// 成功打开数据库时调用处理程序</span>
				<span class="hljs-comment">// 如果版本不同，则更新已有数据库对象或创建对象</span>
				request.onupgradeneeded = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
					<span class="hljs-keyword">var</span> db = event.target.result;

					<span class="hljs-comment">// 设置键生成器（autoIncrement: true），默认不开启</span>
					<span class="hljs-comment">// 使用主键创建 object store</span>
					<span class="hljs-keyword">var</span> objectStore = db.createObjectStore(<span class="hljs-string">"customers"</span>, { <span class="hljs-attr">keyPath</span>: <span class="hljs-string">"ssn"</span> });

					<span class="hljs-comment">// 定义需要的索引</span>
					objectStore.createIndex(<span class="hljs-string">"name"</span>, <span class="hljs-string">"name"</span>, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">false</span> });
					objectStore.createIndex(<span class="hljs-string">"email"</span>, <span class="hljs-string">"email"</span>, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> });

					<span class="hljs-comment">// 向对象添加数据</span>
					customerData.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">customer</span>) </span>{
							objectStore.add(customer);
					});

				};

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>) </span>{

					<span class="hljs-comment">// 查询特定对象的事务，指定模式 - 只读，读写和版本变更</span>
					<span class="hljs-keyword">var</span> transaction = db.transaction([<span class="hljs-string">"customers"</span>], <span class="hljs-string">"readwrite"</span>);

					<span class="hljs-comment">// 当所有数据添加到数据库时调用处理程序</span>
					transaction.oncomplete = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
						<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Add Completed!"</span>);
					};

					<span class="hljs-comment">// 错误处理程序</span>
					transaction.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{

					};

					<span class="hljs-keyword">const</span> customerDataNew = [{ <span class="hljs-attr">ssn</span>: <span class="hljs-string">"777-77-7777"</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Test3"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">32</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"test3@home.org"</span> }];

					<span class="hljs-comment">// 添加新的客户数据到 store 中</span>
					<span class="hljs-keyword">var</span> objectStore = transaction.objectStore(<span class="hljs-string">"customers"</span>);
					customerDataNew.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">customer</span>) </span>{
						<span class="hljs-keyword">var</span> request = objectStore.add(customer);
						request.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Data Added..."</span>+event.target.result);
						};
					});
				}


				<span class="hljs-comment">// 通过主键和 delete 方法从 store 中删除数据</span>
				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteData</span>(<span class="hljs-params"></span>)
				</span>{
					<span class="hljs-keyword">var</span> request = db.transaction([<span class="hljs-string">"customers"</span>], <span class="hljs-string">"readwrite"</span>)
									.objectStore(<span class="hljs-string">"customers"</span>)
									.delete(<span class="hljs-string">"777-77-7777"</span>);
					request.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
					<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Record Deleted!"</span>);
					};
				}

				<span class="hljs-comment">// 通过主键和 get 方法从 store 中读取数据</span>
				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>)
				</span>{
					<span class="hljs-keyword">var</span> transaction = db.transaction([<span class="hljs-string">"customers"</span>]);
					<span class="hljs-keyword">var</span> objectStore = transaction.objectStore(<span class="hljs-string">"customers"</span>);
					<span class="hljs-keyword">var</span> request = objectStore.get(<span class="hljs-string">"444-44-4444"</span>);
					request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
						<span class="hljs-comment">// 处理错误!</span>
					};
					request.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
						<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML = <span class="hljs-string">"Name for SSN 444-44-4444 is "</span> + request.result.name;
					};
				}


				<span class="hljs-comment">// 通过游标从 store 中读取所有数据</span>
				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readAll</span>(<span class="hljs-params"></span>)
				</span>{

					<span class="hljs-keyword">var</span> objectStore = db.transaction(<span class="hljs-string">"customers"</span>).objectStore(<span class="hljs-string">"customers"</span>);

					<span class="hljs-built_in">console</span>.log(db.transaction(<span class="hljs-string">"customers"</span>));
					<span class="hljs-built_in">console</span>.log(objectStore);
					<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML=<span class="hljs-string">""</span>;

					objectStore.openCursor().onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
					<span class="hljs-keyword">var</span> cursor = event.target.result;

						<span class="hljs-comment">// 迭代游标</span>
                        <span class="hljs-keyword">if</span> (cursor) {
							<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML+=<span class="hljs-string">"SSN: "</span> + cursor.key + <span class="hljs-string">" Name: "</span> + cursor.value.name +<span class="hljs-string">" Age: "</span> + cursor.value.age+<span class="hljs-string">"&lt;br /&gt;"</span>;
							cursor.continue();
						}
						<span class="hljs-keyword">else</span> {
							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No more entries!"</span>);
						}
					};
				}

				<span class="hljs-comment">// 通过主键和 put 方法更新已有数据</span>
				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span>(<span class="hljs-params"></span>)
				</span>{

					<span class="hljs-keyword">var</span> objectStore = db.transaction([<span class="hljs-string">"customers"</span>], <span class="hljs-string">"readwrite"</span>).objectStore(<span class="hljs-string">"customers"</span>);
					<span class="hljs-keyword">var</span> request = objectStore.get(<span class="hljs-string">"444-44-4444"</span>);
					request.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{

					};
					request.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{

                                         <span class="hljs-comment">// 获取当前数据				 </span>
					 <span class="hljs-keyword">var</span> data = event.target.result;

					  <span class="hljs-comment">// 更新值</span>
					  data.age = <span class="hljs-number">42</span>;

					  <span class="hljs-comment">// 存储更新后的对象</span>
					  <span class="hljs-keyword">var</span> requestUpdate = objectStore.put(data);
					   requestUpdate.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
						 <span class="hljs-comment">// 错误</span>
					   };
					   requestUpdate.onsuccess = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{
						 <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Success - the data is updated!"</span>);
					   };
					};
				}


			} <span class="hljs-keyword">else</span> {
				<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No IndexDB support.."</span>);
			}

		</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>


	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
		Welcome to Browser Storage Demos - IndexDB API	<span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"read()"</span>&gt;</span>Read <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"readAll()"</span>&gt;</span>Read all <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"add()"</span>&gt;</span>Add data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"deleteData()"</span>&gt;</span>Delete data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"update()"</span>&gt;</span>Update data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
    <h2>Web SQL 数据库</h2>
    <blockquote>
        <p>“Web SQL 数据库是一个用于将数据存储在数据库中的 Web API，这些数据库可以使用 SQL 的变体进行查询。” ——
            <a href="https://en.wikipedia.org/wiki/Web_SQL_Database">维基百科</a></p>
    </blockquote>
    <p>该规范基于 SQLite。Web SQL 数据库未被所有浏览器支持 —— 该标准已被 W3C 否决，IndexedDB 应该会成为替代品。</p>
    <p>尽管如此，它仍可以在支持的浏览器中使用，如 Safari，Chrome，Opera 及 Edge。</p>
    <pre class="hljs" v-pre><code><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">"-//W3C//DTD HTML 4.01 Strict//EN"</span> <span class="hljs-meta-string">"http://www.w3.org/TR/html4/strict.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Browser Storage Demos - Web SQL API <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span> = <span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">

			<span class="hljs-comment">// 检查浏览器支持情况</span>
			<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.openDatabase) {

				<span class="hljs-keyword">var</span> db;

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDBAndTable</span>(<span class="hljs-params"></span>)
				</span>{
					<span class="hljs-comment">// 打开数据库，如果不存在，则创建数据库 - 数据库名称，版本，描述和所需存储空间</span>
					db = <span class="hljs-built_in">window</span>.openDatabase(<span class="hljs-string">'test_db'</span>, <span class="hljs-string">'1.0'</span>, <span class="hljs-string">'Test DB'</span>, <span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>)
					<span class="hljs-comment">// 事务</span>
					db.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tx</span>) </span>{
						<span class="hljs-comment">// 删除已有的表</span>
						tx.executeSql(<span class="hljs-string">'DROP TABLE IF EXISTS CUSTOMERS'</span>);
						<span class="hljs-comment">// 包含必填字段创建新表，定义主键</span>
						tx.executeSql(<span class="hljs-string">'CREATE TABLE IF NOT EXISTS CUSTOMERS(SSN TEXT PRIMARY KEY , NAME TEXT,AGE INTEGER ,EMAIL TEXT)'</span>, [], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tx, result</span>) </span>{
							<span class="hljs-built_in">console</span>.log(result);
							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Table created Successfully!'</span>);

						}, errorHandler);
					});
				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertData</span>(<span class="hljs-params"></span>)
				</span>{
					db.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tx</span>) </span>{
						 <span class="hljs-comment">// 在表中插入数据，可使用动态变量</span>
						 tx.executeSql(<span class="hljs-string">'INSERT INTO CUSTOMERS(SSN, NAME,AGE,EMAIL) VALUES (?,?,?,?)'</span>,[<span class="hljs-string">"444-44-4444"</span>,<span class="hljs-string">"Bill"</span>,<span class="hljs-number">35</span>,<span class="hljs-string">"bill@company.com"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tx,result</span>) </span>{
							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Record Inserted Successfully "</span>+result.insertId );
						},errorHandler);

						 tx.executeSql(<span class="hljs-string">'INSERT INTO CUSTOMERS(SSN, NAME,AGE,EMAIL) VALUES (?,?,?,?)'</span>,[<span class="hljs-string">"555-55-5555"</span>,<span class="hljs-string">"Test1"</span>,<span class="hljs-number">32</span>,<span class="hljs-string">"test1@company.com"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tx,result</span>) </span>{

							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Record Inserted Successfully "</span>+result.insertId);

						},errorHandler);
					});

				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readDataFromDB</span>(<span class="hljs-params"></span>)
				</span>{

					db.readTransaction(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tx</span>) </span>{
					<span class="hljs-comment">// 从表中读取数据并遍历行对象</span>
					tx.executeSql(<span class="hljs-string">'SELECT * FROM CUSTOMERS'</span>, [], <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tx, results</span>) </span>{
						<span class="hljs-keyword">var</span> len = results.rows.length, i;
						<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML=<span class="hljs-string">""</span>;
						<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; len; i++) {
						 <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML+=<span class="hljs-string">" SSN: "</span> +results.rows.item(i).SSN+ <span class="hljs-string">" Name: "</span>+results.rows.item(i).NAME+<span class="hljs-string">" Age: "</span>+results.rows.item(i).AGE+<span class="hljs-string">"&lt;br /&gt;"</span>;
						}

						},errorHandler);
					});

				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateData</span>(<span class="hljs-params"></span>)
				</span>{
					db.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tx</span>) </span>{
						 <span class="hljs-comment">// 更新已有数据</span>
						 tx.executeSql(<span class="hljs-string">'UPDATE CUSTOMERS SET AGE=? WHERE SSN=?'</span>,[<span class="hljs-number">45</span>,<span class="hljs-string">"444-44-4444"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tx,result</span>) </span>{
							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Record Updated Successfully"</span> +result);
						},errorHandler);

					});

				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteData</span>(<span class="hljs-params"></span>)
				</span>{
					db.transaction(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tx</span>) </span>{
						 <span class="hljs-comment">// 通过主键删除数据</span>
						 tx.executeSql(<span class="hljs-string">'DELETE FROM CUSTOMERS WHERE SSN=?'</span>,[<span class="hljs-string">"444-44-4444"</span>], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">tx,result</span>) </span>{
							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Record Deleted Successfully"</span> +result);
						},errorHandler);

					});

				}

				<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorHandler</span>(<span class="hljs-params">transaction, error</span>) </span>{
					<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Oops. Error was '</span>+error.message+<span class="hljs-string">' (Code '</span>+error.code+<span class="hljs-string">')'</span>);
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}


			} <span class="hljs-keyword">else</span> {
				<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No Web SQL API support.."</span>);
			}
		</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
		Welcome to Browser Storage Demos - Web SQL API	<span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"createDBAndTable()"</span>&gt;</span>Create DB/Table<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"insertData()"</span>&gt;</span>Insert data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"readDataFromDB()"</span>&gt;</span>Read data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"updateData()"</span>&gt;</span>Update data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"deleteData()"</span>&gt;</span>Delete data <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
    <h2>CacheStorage</h2>
    <blockquote>
        <p>“CacheStorage 是一种浏览器中的存储机制，用于存储和查询网络请求和响应。它存储一对 Request 和 Response 对象，Request 作为键，Response 作为值。”</p>
        <p>—— <a href="undefined">Chidume Nnamdi</a> 的
            <a href="https://blog.bitsrc.io/introduction-to-the-cache-storage-a-new-browser-cache-pwa-api-a5d7426a2456">Bits and Pieces</a> 专栏
        </p>
    </blockquote>
    <p>CacheStorage API 可以在 Window 上下文（DOM 上下文）中使用，也可以和 Service Worker API 一起使用以实现离线访问。在本教程中，我们将更多地讨论 DOM 上下文。</p>
    <p>CacheStorage 用于在网站中存储网络请求和响应，也可以作为存储工具。例如，我们可以存储个性化数据（如用户偏好）在缓存中，按需查询这些数据。<code>put</code> 方法可用于将个性化响应对象存储在缓存存储中。
    </p>
    <p>CacheStorage API 允许我们从跨域网站获取和缓存数据。CacheStorage API 是异步的，不会阻塞 UI 渲染。CacheStorage 选项是最新加入浏览器存储的，有些浏览器仍未支持。</p>
    <pre class="hljs" v-pre><code><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span> <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">"-//W3C//DTD HTML 4.01 Strict//EN"</span> <span class="hljs-meta-string">"http://www.w3.org/TR/html4/strict.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Browser Storage Demos - Cache Storage API <span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span> = <span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">

				<span class="hljs-comment">// 检查浏览器支持情况</span>
				<span class="hljs-keyword">if</span>(<span class="hljs-string">'caches'</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {

					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>)
					</span>{
						<span class="hljs-comment">// 打开缓存存储，如果不存在，则新建</span>
						caches.open(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {

							<span class="hljs-comment">// 从源服务器获取 data.json，添加响应到缓存存储中</span>
							<span class="hljs-comment">// 允许跨域响应缓存 —— 指定完整的请求 URL</span>
							<span class="hljs-comment">// Request 对象作为键</span>
							cache.add(<span class="hljs-keyword">new</span> Request(<span class="hljs-string">'/data.json'</span>));

							<span class="hljs-keyword">var</span> data={<span class="hljs-attr">foo</span>: <span class="hljs-string">"bar"</span>};

							<span class="hljs-comment">// 在缓存前将其他头选项加入响应对象</span>
							<span class="hljs-keyword">const</span> jsonResponse = <span class="hljs-keyword">new</span> Response(<span class="hljs-built_in">JSON</span>.stringify(data), {
								  <span class="hljs-attr">headers</span>: {
									<span class="hljs-string">'content-type'</span>: <span class="hljs-string">'application/json'</span>
								  }
							});

							<span class="hljs-comment">// 将自定义 JSON 数据加入缓存存储</span>
							cache.put(<span class="hljs-string">'/custom.json'</span>, jsonResponse);

						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
							<span class="hljs-built_in">console</span>.log(err);
						});
					}

					<span class="hljs-comment">// 将多个 URL 加入缓存 —— 浏览器从源获取数据</span>
					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addAll</span>(<span class="hljs-params"></span>)
					</span>{
						caches.open(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {
							<span class="hljs-keyword">const</span> urls = [<span class="hljs-string">'/data1.json'</span>, <span class="hljs-string">'/data2.json'</span>,<span class="hljs-string">'/data3.json'</span>];
							cache.addAll(urls);
						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
							<span class="hljs-built_in">console</span>.log(err);
						});
					}


					<span class="hljs-comment">// 检查缓存存储状态</span>
					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkCacheStatus</span>(<span class="hljs-params"></span>)
					</span>{
						caches.has(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">bool</span>) =&gt;</span> {

						 <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML = <span class="hljs-string">"Cache data_cache is available: "</span> + bool+<span class="hljs-string">"&lt;br /&gt;"</span>;

						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
						})

						caches.has(<span class="hljs-string">'teat_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">bool</span>) =&gt;</span> {

						 <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML += <span class="hljs-string">"Cache test_cache is available: "</span> + bool;

						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
						})

					}

					<span class="hljs-comment">// 删除缓存存储</span>
					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteCache</span>(<span class="hljs-params"></span>)
					</span>{
							caches.delete(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">bool</span>) =&gt;</span> {
							<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML = <span class="hljs-string">"Cache data_cache is deleted"</span>;
						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
						})
					}

					<span class="hljs-comment">// 通过缓存键（请求 URL 或对象）从缓存中删除指定对象</span>
					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deleteCacheObject</span>(<span class="hljs-params"></span>)
					</span>{
							caches.open(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {

							cache.delete(<span class="hljs-string">'custom.json'</span>);

						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
							<span class="hljs-built_in">console</span>.log(err);
						});
					}

					<span class="hljs-comment">// 从缓存存储中获取所有缓存键</span>
					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAllKeys</span>(<span class="hljs-params"></span>)
					</span>{
							caches.open(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {

							<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML = <span class="hljs-string">""</span>;
							cache.keys().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keys</span>) </span>{
								keys.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">key</span>) </span>{
										<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML += key.url+<span class="hljs-string">"&lt;br /&gt;"</span>;
								});
							});


						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
							<span class="hljs-built_in">console</span>.log(err);
						});
					}

					<span class="hljs-comment">// 从缓存存储中获取缓存数据</span>
					<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCacheData</span>(<span class="hljs-params"></span>)
					</span>{
						caches.open(<span class="hljs-string">'data_cache'</span>).then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {
						<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML = <span class="hljs-string">""</span>;
								cache.match(<span class="hljs-string">'custom.json'</span>).then(<span class="hljs-function">(<span class="hljs-params">response</span>)=&gt;</span> {
								response.json().then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
									<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"data"</span>).innerHTML = <span class="hljs-built_in">JSON</span>.stringify(data);
								});

								})

						}).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
							<span class="hljs-built_in">console</span>.log(err);
						});
					}

			} <span class="hljs-keyword">else</span> {
					<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No Cache Storage API support.."</span>);
			}

		</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
		Welcome to Browser Storage Demos - Cache Storage API	<span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span>

		<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"add()"</span>&gt;</span>Add to Cache <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"addAll()"</span>&gt;</span>Add All<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"checkCacheStatus()"</span>&gt;</span>Cache Status <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"deleteCache()"</span>&gt;</span>Delete Cache <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"deleteCacheObject()"</span>&gt;</span>Delete Cache Object<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"getAllKeys()"</span>&gt;</span>Get All Keys<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span> = <span class="hljs-string">"getCacheData()"</span>&gt;</span>Get Cache Data<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
    <p>相关演示参见<a href="https://github.com/techforum-repo/youttubedata/tree/master/browser-storage-demos">浏览器存储演示</a>（这个演示是在 Node.js 上使用 Express.js 构建的）。
    </p>
    <p>在用户浏览器上存储数据有多样的选择 —— 根据你的使用场景进行选择。</p>
    <p>你可以选择使用 CacheStorage API 存储供离线访问的数据，而在存储大量应用或用户生成的数据的情况下，IndexedDB 是更好的选择。当然，Cookie 仍可以用于存储用于服务器识别的小型数据。</p>
    <p>本地存储（localStorage）和会话存储（sessionStorage）则可用于存储少量数据。本地存储和会话存储的 API 是同步的，因此它们会影响 UI 渲染。但与此同时，它们这两个 API 易于在项目中使用。</p>
    <blockquote>
        <p>如果发现译文存在错误或其他需要改进的地方，欢迎到 <a href="https://github.com/xitu/gold-miner">掘金翻译计划</a> 对译文进行修改并 PR，也可获得相应奖励积分。文章开头的
            <strong>本文永久链接</strong> 即为本文在 GitHub 上的 MarkDown 链接。</p>
    </blockquote>
    <hr>
    <blockquote>
        <p><a href="https://github.com/xitu/gold-miner">掘金翻译计划</a> 是一个翻译优质互联网技术文章的社区，文章来源为
            <a href="https://juejin.im">掘金</a> 上的英文分享文章。内容覆盖
            <a href="https://github.com/xitu/gold-miner#android">Android</a>、<a href="https://github.com/xitu/gold-miner#ios">iOS</a>、<a href="https://github.com/xitu/gold-miner#%E5%89%8D%E7%AB%AF">前端</a>、<a href="https://github.com/xitu/gold-miner#%E5%90%8E%E7%AB%AF">后端</a>、<a href="https://github.com/xitu/gold-miner#%E5%8C%BA%E5%9D%97%E9%93%BE">区块链</a>、<a href="https://github.com/xitu/gold-miner#%E4%BA%A7%E5%93%81">产品</a>、<a href="https://github.com/xitu/gold-miner#%E8%AE%BE%E8%AE%A1">设计</a>、<a href="https://github.com/xitu/gold-miner#%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD">人工智能</a>等领域，想要查看更多优质译文请持续关注
            <a href="https://github.com/xitu/gold-miner">掘金翻译计划</a>、<a href="http://weibo.com/juejinfanyi">官方微博</a>、<a href="https://zhuanlan.zhihu.com/juejinfanyi">知乎专栏</a>。
        </p>
    </blockquote>
</div>
<div class="footer"></div>
</body>
<script src="/assets/scripts/index.js"></script>
<script>init()</script>
</html>
